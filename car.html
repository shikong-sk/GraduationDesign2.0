<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta plateNum="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <script src="Assets/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="Assets/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="Assets/js/popper.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="Assets/js/vue.js" type="text/javascript" charset="utf-8"></script>
    <script src="Assets/js/axios.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="Assets/js/qs.min.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="Assets/css/bootstrap.min.css" />

    <link rel="stylesheet" type="text/css" href="Assets/css/swiper.min.css" />

    <script src="Assets/js/swiper.min.js" type="text/javascript" charset="utf-8"></script>

    <script src="Assets/js/element-ui.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="Assets/css/element-ui.css" />

    <script src="Assets/js/vuex.js" type="text/javascript" charset="utf-8"></script>

    <script src="Assets/js/tinymce/tinymce.min.js" type="text/javascript" charset="utf-8"></script>

    <script src="Assets/js/jquery.base64.js" type="text/javascript" charset="utf-8"></script>

    <script src="Assets/js/echarts.min.js" type="text/javascript" charset="utf-8"></script>

    <style type="text/css">
        .text-danger {
            color: #F56C6C !important;
        }
        
        [v-cloak] {
            display: none;
        }
    </style>

    <script type="text/javascript">
        //公用函数定义
        function sleep(fun, ms) {
            setTimeout(fun, ms);
        }

        function loop(fun, ms) {
            fun();
            setInterval(fun, ms);
        }

        addEventListener(
            "load",
            function() {
                setTimeout(hideURLbar, 0);
            },
            false
        );

        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    </script>
</head>

<body class="body">

    <div id="car" v-cloak>
        <el-row v-if="carFlag">
            <el-col :sm="4" class="text-center">
                <img style="max-width: 120px;max-height: 50px;text-align: center;" src="Storage/global/Logo.png" alt="logo" class="img-fluid">
            </el-col>
            <el-col :sm="16" :xs="24">
                <el-menu :default-active="activeIndex" mode="horizontal" @select="handleSelect">
                    <el-menu-item index="1" @click="linkTo('./management.html')">平台概览</el-menu-item>
                    <el-menu-item index="2" @click="linkTo('./personnel.html')">人员管理</el-menu-item>
                    <el-menu-item index="3" @click="linkTo('./car.html')">车辆管理</el-menu-item>
                    <el-menu-item index="4" @click="linkTo('./equipment.html')">设备管理</el-menu-item>
                    <el-menu-item v-if="role == '超级管理员' " index="6" @click="linkTo('./plan.html')">区域/场所管理</el-menu-item>
                    <el-menu-item v-if="role == '超级管理员' " index="7" @click="linkTo('./userManagement.html')">用户管理</el-menu-item>
                    <el-menu-item v-if="role == '超级管理员' " index="8" @click="linkTo('./role.html')">权限管理</el-menu-item>
                </el-menu>
            </el-col>
            <el-col :md="4" :xs="24">
                <el-row>
                    <el-col :span="12" v-if="role != '超级管理员'">
                        <div style="padding-top: 10px; text-align: center;" class="mx-auto">
                            <div>{{dareaName}}</div>
                            <div @click="()=>{areaDialog = true}" class="mx-auto w-100" style="font-size: 0.95rem;line-height: calc(0.95rem * 2);">
                                切换区域
                            </div>
                        </div>
                    </el-col>

                    <el-col :span="role != '超级管理员'?12:24">
                        <div style="padding-top: 10px; text-align: center;" class="mx-auto">
                            <el-dropdown class="text-center">
                                <span class="el-dropdown-link">
										{{role}}<br><span style="display: inline-block; width: 100%;">{{userName}}</span><i class="el-icon-arrow-down el-icon--right"></i>
                                </span>
                                <el-dropdown-menu slot="dropdown">
                                    <el-dropdown-item><span @click="linkTo('./')">返回首页</span></el-dropdown-item>
                                    <el-dropdown-item divided>
                                        <div @click="(x)=>{logout()}">退出登录</div>
                                    </el-dropdown-item>
                                </el-dropdown-menu>
                            </el-dropdown>
                        </div>
                    </el-col>
                </el-row>
            </el-col>
        </el-row>


        <el-dialog title="请选择管理区域" v-if="role != '超级管理员'" :visible.sync="areaDialog" :show-close="true" :close-on-press-escape="true" :close-on-click-modal="false">
            <el-row>
                <el-row>
                    <el-col class="text-center border" :sm="12" :xs="24">
                        <el-select v-model="area" remote :remote-method="(v)=>{loadArea(v)}" @change="(v)=>{loadArea(v);darea = '';}" filterable placeholder="请选择区域">
                            <div v-for="(v,k) in areaList">
                                <el-option v-for="(val,key) in v" :key="k" :label="val" :value="k">
                                </el-option>
                            </div>
                        </el-select>
                    </el-col>
                    <el-col class="text-center border" :sm="12" :xs="24">
                        <el-select v-model="darea" remote :remote-method="(v)=>{loadDarea(v)}" @change="(v)=>{loadDarea(v)}" filterable placeholder="请选择场所" :disabled="area.length == 0">
                            <div v-if="(Object.keys(areaList).length != 0 && area.length != 0)">
                                <el-option v-for="(v,k) in dareaList[area].darea" :key="k" :label="v.dareaName" :value="k" v-if="v.selectCar == '1'">
                                </el-option>
                            </div>
                        </el-select>
                    </el-col>
                </el-row>
            </el-row>

            <span slot="footer" class="dialog-footer">
					<el-button :disabled="firstLoadDialog" @click="()=>{areaDialog = false}">取 消</el-button>
					<el-button type="primary" :disabled="area.length == 0 || darea.length == 0" @click="()=>{
						firstLoadDialog=false;areaDialog = false;CurrentChange();saveDefault()
					}">确
						定</el-button>
				</span>
        </el-dialog>

        <el-row>
            <el-col class="text-center border" :xs="24" :sm="24" :md="24">
                <h5>管理区域详细信息</h5>
                <!--                <el-row>
                    <el-col :xs="12" :sm="12" :md="12">车辆信息总数量</el-col>
                    <el-col :xs="12" :sm="12" :md="12">{{carNum}}</el-col>
                </el-row> -->
            </el-col>

            <div>
                <el-row>
                    <!-- 					<el-col :span="24">
						  <el-cascader
							class="w-100"
						    :options="[
								{
									value:1,
									label:'广东',
									children:[
										{
											value:2,
											label:'汕头',
											children:[
												{
													value:3,
													label:'金平区',
													children:[
														{
															value:4,
															label:'大华街道',
														},
														{
															value:5,
															label:'东夏街道',
														}
													]
												}
											]
										}
									]
								},
							]"
						    :props="{ multiple: true }"
							@change="(v)=>{searchDarea(v)}"
						    collapse-tags
							filterable
						    clearable></el-cascader>
					</el-col>
 -->
                    <el-col class="" :sm="24" :xs="24" :md="6">
                        <el-select class="w-100" v-model="carData.searchPlan" remote :remote-method="(v)=>{searchDarea(v)}" @change="(v)=>{searchDarea(v)}" filterable placeholder="请选择搜索范围">
                            <el-option label="所有可查询范围" :value="0">
                            </el-option>
                            <div v-if="(Object.keys(areaList).length != 0 && area.length != 0)">
                                <el-option v-for="(v,k) in dareaList[area].darea" :key="k" :label="v.dareaName" :value="k" v-if="v.selectCar == '1'">
                                </el-option>
                            </div>
                        </el-select>
                    </el-col>
                    <el-col :sm="12" :xs="24" :md="6">
                        <el-select class="w-100" v-model="area" remote :remote-method="(v)=>{loadArea(v)}" @change="(v)=>{loadArea(v);darea = '';}" filterable placeholder="请选择区域">
                            <div v-for="(v,k) in areaList">
                                <el-option v-for="(val,key) in v" :key="k" :label="val" :value="k">
                                </el-option>
                            </div>
                        </el-select>
                    </el-col>
                    <el-col :sm="12" :xs="24" :md="6">
                        <el-select class="w-100" v-model="darea" remote :remote-method="(v)=>{loadDarea(v)}" @change="(v)=>{loadDarea(v)}" filterable placeholder="请选择场所" :disabled="area.length == 0">
                            <div v-if="(Object.keys(areaList).length != 0 && area.length != 0)">
                                <el-option v-for="(v,k) in dareaList[area].darea" :key="k" :label="v.dareaName" :value="k" v-if="v.selectCar == '1' || permission == '8' ">
                                </el-option>
                            </div>
                            </el-selectclass="w-100">
                    </el-col>

                    <el-col :sm="24" :xs="24" :md="6">
                        <el-input v-model="carData.filter.dareaName" placeholder="场所名称" clearable @clear="()=>{carData.filter.dareaName = clear()}" @change="(v)=>{carData.filter.dareaName = change(v)}">
                        </el-input>
                    </el-col>



                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.plateNum" placeholder="车牌号码" clearable @clear="()=>{carData.filter.plateNum = clear()}" @change="(v)=>{carData.filter.plateNum = change(v)}">
                        </el-input>
                    </el-col>

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="性别" v-model="carData.filter.gender" clearable @clear="()=>{carData.filter.gender = clear()}">
                            <el-option label="男" value="男"></el-option>
                            <el-option label="女" value="女"></el-option>
                        </el-select>
                    </el-col> -->

                    <!--                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.idCard" placeholder="证件号码" clearable @clear="()=>{carData.filter.idCard = clear()}" @change="(v)=>{carData.filter.idCard = change(v)}">
                        </el-input>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="证件类型" v-model="carData.filter.cardType" clearable @clear="()=>{carData.filter.cardType = clear()}">
                            <el-option label="居民身份证" value="1"></el-option>
                            <el-option label="港澳台居住证" value="2"></el-option>
                            <el-option label="中国护照" value="3"></el-option>
                            <el-option label="国外护照" value="4"></el-option>
                            <el-option label="永久居住证" value="5"></el-option>
                            <el-option label="其他" value="9"></el-option>
                        </el-select>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.countryOrAreaCode" placeholder="国家/地区代码" clearable @clear="()=>{carData.filter.countryOrAreaCode = clear()}" @change="(v)=>{carData.filter.countryOrAreaCode = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.countryOrAreaName" placeholder="国家地区名称" clearable @clear="()=>{carData.filter.countryOrAreaName = clear()}" @change="(v)=>{carData.filter.countryOrAreaName = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.cardVersion" placeholder="证件版本号" clearable @clear="()=>{carData.filter.cardVersion = clear()}" @change="(v)=>{carData.filter.cardVersion = change(v)}">
                        </el-input>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.currentApplyOrgCode" placeholder="受理机关代码" clearable @clear="()=>{carData.filter.currentApplyOrgCode = clear()}" @change="(v)=>{carData.filter.currentApplyOrgCode = change(v)}">
                        </el-input>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="8" :md="6">
                        <el-input v-model="carData.filter.signNum" placeholder="签发次数" clearable @clear="()=>{carData.filter.signNum = clear()}" @change="(v)=>{carData.filter.signNum = change(v)}">
                        </el-input>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="16" :md="18">
                        <el-input v-model="carData.filter.address" placeholder="联系地址" clearable @clear="()=>{carData.filter.address = clear()}" @change="(v)=>{carData.filter.address = change(v)}">
                        </el-input>
                    </el-col> -->

                    <el-col :xs="24" :sm="12" :md="4">
                        <el-select class="w-100" filterable placeholder="时间条件" v-model="carData.timeFilter" clearable @clear="()=>{
								carData.filter.beforeTime = clear()
								carData.filter.afterTime = clear()
								carData.filter.betweenTime = clear()
							}" @change="(v)=>{
								carData.filter.beforeTime = clear()
								carData.filter.afterTime = clear()
								carData.filter.betweenTime = clear()
							}">
                            <el-option label="在...时间段内" value="0"></el-option>
                            <el-option label="在此时间之前" value="1"></el-option>
                            <el-option label="在此时间之后" value="2"></el-option>
                        </el-select>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="8">
                        <el-date-picker v-if="carData.timeFilter == 0" class="w-100" type="datetimerange" range-separator="至" start-placeholder="开始日期" end-placeholder="结束日期" v-model="carData.filter.betweenTime" clearable @clear="()=>{carData.filter.betweenTime = clear();carData.filter.betweenTime = undefined}"
                            @change="(v)=>{carData.filter.betweenTime = change(v)}">
                        </el-date-picker>

                        <el-date-picker v-if="carData.timeFilter == 1" class="w-100" type="datetime" placeholder="选择日期时间" v-model="carData.filter.beforeTime" clearable @clear="()=>{carData.filter.beforeTime = clear()}">
                        </el-date-picker>

                        <el-date-picker v-if="carData.timeFilter == 2" class="w-100" type="datetime" placeholder="选择日期时间" v-model="carData.filter.afterTime" clearable @clear="()=>{carData.filter.afterTime = clear()}">
                        </el-date-picker>

                    </el-col>
                    <!--                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="体温筛选" v-model="carData.tempFilter" clearable @clear="()=>{
								carData.filter.higherTemp = clear()
								carData.filter.lowerTemp = clear()
							}" @change="(v)=>{
								carData.filter.higherTemp = clear()
								carData.filter.lowerTemp = clear()
							}">
                            <el-option label="体温高于" value="0"></el-option>
                            <el-option label="体温低于" value="1"></el-option>
                        </el-select>
                    </el-col> -->

                    <!--                    <el-col :xs="24" :sm="12" :md="6">

                        <el-input-number class="w-100" v-if="carData.tempFilter == 0" v-model="carData.filter.higherTemp" :min="0" :precision="2" :step="0.05" :max="50"></el-input-number>
                        <el-input-number class="w-100" v-if="carData.tempFilter == 1" v-model="carData.filter.lowerTemp" :min="0" :precision="2" :step="0.05" :max="50"></el-input-number>

                    </el-col> -->

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.equipmentName" placeholder="登记设备名称" clearable @clear="()=>{carData.filter.equipmentName = clear()}" @change="(v)=>{carData.filter.equipmentName = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.equipmentId" placeholder="登记设备编码" clearable @clear="()=>{carData.filter.equipmentId = clear()}" @change="(v)=>{carData.filter.equipmentId = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="登记设备类型" v-model="carData.filter.equipmentType" clearable @clear="()=>{carData.filter.equipmentType = clear()}">
                            <el-option label="访客机" value="01"></el-option>
                            <el-option label="门禁机" value="02"></el-option>
                            <el-option label="车辆道闸" value="03"></el-option>
                        </el-select>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="出入标识" v-model="carData.filter.status" clearable @clear="()=>{carData.filter.status = clear()}">
                            <el-option label="入" value="0"></el-option>
                            <el-option label="出" value="1"></el-option>
                        </el-select>
                    </el-col>

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.stationId" placeholder="警务站编号" clearable @clear="()=>{carData.filter.stationId = clear()}" @change="(v)=>{carData.filter.stationId = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.stationName" placeholder="警务站名称" clearable @clear="()=>{carData.filter.stationName = clear()}" @change="(v)=>{carData.filter.stationName = change(v)}">
                        </el-input>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="场所类型" v-model="carData.filter.placeType" clearable @clear="()=>{carData.filter.placeType = clear()}">
                            <el-option label="封闭式小区" value="01"></el-option>
                            <el-option label="小区" value="02"></el-option>
                            <el-option label="无人管理小区" value="03"></el-option>
                            <el-option label="旅店/宾馆/酒店" value="04"></el-option>
                            <el-option label="停车场" value="05"></el-option>
                            <el-option label="娱乐场所" value="06"></el-option>
                            <el-option label="政府单位" value="07"></el-option>
                            <el-option label="企事业单位" value="08"></el-option>
                            <el-option label="学校" value="09"></el-option>
                            <el-option label="车站/机场" value="10"></el-option>
                            <el-option label="宗教场所" value="11"></el-option>
                            <el-option label="医院" value="12"></el-option>
                            <el-option label="超市/商场/市场" value="13"></el-option>
                            <el-option label="广场/公园" value="14"></el-option>
                            <el-option label="体育馆" value="15"></el-option>
                            <el-option label="旅游景点" value="16"></el-option>
                            <el-option label="其他" value="99"></el-option>
                        </el-select>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.dareaName" placeholder="场所名称" clearable @clear="()=>{carData.filter.dareaName = clear()}" @change="(v)=>{carData.filter.dareaName = change(v)}">
                        </el-input>
                    </el-col> -->
                    <!-- 
                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="车辆类别" v-model="carData.filter.identity" clearable @clear="()=>{carData.filter.identity = clear()}">
                            <el-option label="业主" value="1"></el-option>
                            <el-option label="租户" value="2"></el-option>
                            <el-option label="访客" value="3"></el-option>
                        </el-select>
                    </el-col> -->

                    <!-- <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.homePlace" placeholder="家庭住址" clearable @clear="()=>{carData.filter.homePlace = clear()}" @change="(v)=>{carData.filter.homePlace = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.contact" placeholder="联系方式" clearable @clear="()=>{carData.filter.contact = clear()}" @change="(v)=>{carData.filter.contact = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="人证一致" v-model="carData.filter.isConsist" clearable @clear="()=>{carData.filter.isConsist = clear()}">
                            <el-option label="一致" value="1"></el-option>
                            <el-option label="不一致" value="0"></el-option>
                        </el-select>
                    </el-col>


                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="人证相似度筛选" v-model="carData.compareScoreFilter" clearable @clear="()=>{
								carData.filter.higherCompareScore = clear()
								carData.filter.lowerCompareScore = clear()
							}" @change="(v)=>{
								carData.filter.higherCompareScore = clear()
								carData.filter.lowerCompareScore = clear()
							}">
                            <el-option label="人证相似度高于" value="0"></el-option>
                            <el-option label="人证相似度低于" value="1"></el-option>
                        </el-select>
                    </el-col>
                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input-number class="w-100" v-if="carData.compareScoreFilter == 0" v-model="carData.filter.higherCompareScore" :precision="0" :step="1" :min="0" :max="100"></el-input-number>
                        <el-input-number class="w-100" v-if="carData.compareScoreFilter == 1" v-model="carData.filter.lowerCompareScore" :precision="0" :step="1" :min="0" :max="100"></el-input-number>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-select class="w-100" filterable placeholder="开门方式" v-model="carData.filter.openMode" clearable @clear="()=>{carData.filter.openMode = clear()}">
                            <el-option label="人脸识别" value="1"></el-option>
                            <el-option label="门禁卡" value="2"></el-option>
                            <el-option label="密码开门" value="3"></el-option>
                            <el-option label="APP开门" value="4"></el-option>
                            <el-option label="人脸与身份证识别比对" value="5"></el-option>
                            <el-option label="手机邀请码" value="6"></el-option>
                            <el-option label="访客门铃" value="7"></el-option>
                            <el-option label="可视对讲机" value="8"></el-option>
                            <el-option label="其它" value="9"></el-option>
                        </el-select>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-input v-model="carData.filter.visitReason" placeholder="访问事由" clearable @clear="()=>{carData.filter.visitReason = clear()}" @change="(v)=>{carData.filter.visitReason = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="8" :md="8">
                        <el-input v-model="carData.filter.mac" placeholder="手机 MAC 地址（APP）" clearable @clear="()=>{carData.filter.mac = clear()}" @change="(v)=>{carData.filter.mac = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="8" :md="8">
                        <el-input v-model="carData.filter.imsi" placeholder="手机 IMSI（APP）" clearable @clear="()=>{carData.filter.imsi = clear()}" @change="(v)=>{carData.filter.imsi = change(v)}">
                        </el-input>
                    </el-col>

                    <el-col :xs="24" :sm="8" :md="8">
                        <el-input v-model="carData.filter.imei" placeholder="手机 IMEI（APP）" clearable @clear="()=>{carData.filter.imei = clear()}" @change="(v)=>{carData.filter.imei = change(v)}">
                        </el-input>
                    </el-col> -->

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-row>
                            <el-col :xs="12" :sm="12" :md="12">
                                <el-button type="danger" class="w-100" @click="()=>{showAddCarDialog()}">添加车辆信息</el-button>
                            </el-col>

                            <el-col :xs="12" :sm="12" :md="12">
                                <el-button type="primary" class="w-100" @click="()=>{search(Tab)}">搜索</el-button>
                            </el-col>
                        </el-row>
                    </el-col>

                </el-row>
            </div>

            <el-col class="text-center border" :xs="24" :sm="24" :md="24">
                <el-table :data="carData.data" style="width: 100%" border>
                    <el-table-column type="expand" width="25">
                        <template slot-scope="props">
								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="车牌号码">
										<span>{{props.row.plateNum}}</span>
									</el-form-item>
								</el-form>
<!-- 								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="性别">
										<span>{{props.row.gender}}</span>
									</el-form-item>
								</el-form>
								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="民族">
										<span>{{props.row.nation}}</span>
									</el-form-item>
								</el-form> -->
<!-- 								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="证件号码">
										<span>{{props.row.idCard}}</span>
									</el-form-item>
								</el-form> -->
<!-- 								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="证件类型">
										<span v-if="props.row.cardType == '1'">居民身份证</span>
										<span v-if="props.row.cardType == '2'">港澳台居住证</span>
										<span v-if="props.row.cardType == '3'">中国护照</span>
										<span v-if="props.row.cardType == '4'">国外护照</span>
										<span v-if="props.row.cardType == '5'">永久居住证</span>
										<span v-if="props.row.cardType == '9'">其他</span>
									</el-form-item>
								</el-form> -->
								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="现场照片">
										<el-image v-if="props.row.vehicleImg != ''" :preview-src-list="
										props.row.vehicleImg != '' && props.row.plateImg != ''
										?['./'+props.row.vehicleImg,'./'+props.row.plateImg]
										: props.row.vehicleImg != '' && props.row.plateImg == '' 
											? ['./'+props.row.vehicleImg]
											: ['./'+props.row.plateImg]
										"
										 style="width: 10rem;height:10rem;" :src="'./'+props.row.vehicleImg" fit="scale-down">
										</el-image>
										<span v-else> 未录入照片 </span>
									</el-form-item>
								</el-form>
								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="证件照片">
										<el-image v-if="props.row.plateImg != ''" :preview-src-list="
										props.row.vehicleImg != '' && props.row.plateImg != ''
										?['./'+props.row.vehicleImg,'./'+props.row.plateImg]
										: props.row.vehicleImg != '' && props.row.plateImg == '' 
											? ['./'+props.row.vehicleImg]
											: ['./'+props.row.plateImg]
										"
										 style="width: 10rem;height:10rem;" :src="'./'+props.row.plateImg" fit="scale-down">
										</el-image>
										<span v-else> 未录入照片 </span>
									</el-form-item>
								</el-form>
								<el-form label-position="left" inline class="table-expand">
									<el-form-item label="出入标识">
										<span v-if="props.row.status == '0'">入</span>
										<span v-else>出</span>
									</el-form-item>
								</el-form>
							</template>
                    </el-table-column>
                    <el-table-column label="时间" width="155" :show-overflow-tooltip="true">
                        <template slot-scope="scope">
								{{scope.row.passTime}}
							</template>
                    </el-table-column>
                    <el-table-column label="车牌号码" :show-overflow-tooltip="true">
                        <template slot-scope="scope">
								{{scope.row.plateNum}}
							</template>
                    </el-table-column>
                    <el-table-column label="场所" :show-overflow-tooltip="true">
                        <template slot-scope="scope">
								{{scope.row.dareaName}}
							</template>
                    </el-table-column>
                    <el-table-column label="设备" :show-overflow-tooltip="true">
                        <template slot-scope="scope">
								{{scope.row.equipmentName}}
							</template>
                    </el-table-column>
                    <el-table-column label="车辆照片" width="100">
                        <template slot-scope="scope">
							<div class="mx-auto text-center">
								<el-image v-if="scope.row.vehicleImg != ''" :preview-src-list="
								scope.row.vehicleImg != '' && scope.row.plateImg != ''
								?['./'+scope.row.vehicleImg,'./'+scope.row.plateImg]
								: scope.row.vehicleImg != '' && scope.row.plateImg == '' 
									? ['./'+scope.row.vehicleImg]
									: ['./'+scope.row.plateImg]
								"
								 style="width: 100%;height:50px" :src="'./'+scope.row.vehicleImg" fit="scale-down">
								</el-image>
								<span v-else> 未录入照片 </span>
							</div>
							</template>
                    </el-table-column>
                    <el-table-column label="车牌照片" width="100">
                        <template slot-scope="scope">
							<div class="mx-auto text-center">
								<el-image v-if="scope.row.plateImg != ''" :preview-src-list="
								scope.row.vehicleImg != '' && scope.row.plateImg != ''
								?['./' + scope.row.vehicleImg,'./' + scope.row.plateImg]
								: scope.row.vehicleImg != '' && scope.row.plateImg == '' 
									? ['./' + scope.row.vehicleImg]
									: ['./' + scope.row.plateImg]
								"
								style="width: 100%;height:50px;" :src="'./' + scope.row.plateImg" fit="scale-down">
								</el-image>
								<span v-else> 未录入照片 </span>
							</div>
							</template>
                    </el-table-column>
                    <!--                    <el-table-column label="体温" :show-overflow-tooltip="true" width="65">
                        <template slot-scope="scope">
								{{scope.row.temp}}
							</template>
                    </el-table-column> -->
                    <el-table-column fixed="right" label="操作" width="60">
                        <template slot-scope="scope">
								<div class="text-center">
									<el-button style="padding:5px 0;margin:0 auto" @click="select(scope)" type="text" size="small">查看</el-button>
									<el-button v-if="permission == '8' || dareaList[scope.row.area].darea[scope.row.darea].updateCar" style="padding:5px 0;margin:0 auto"
									 type="text" size="small" @click="edit(scope)">修改</el-button>
									<el-button v-if="permission == '8' || dareaList[scope.row.area].darea[scope.row.darea].delCar" style="padding:5px 0;margin:0 auto"
									 type="text" size="small" @click="del(scope)">删除</el-button>
								</div>
							</template>
                    </el-table-column>
                </el-table>
                <el-pagination @size-change="(v)=>{carData.num = v ;CurrentChange(carData.page) }" @current-change="(v)=>{CurrentChange(v)}" :total="carData.count" :current-page.sync="carData.page" :page-sizes="[10,20,50,100,200,500,1000]" :page-size="carData.num" layout="total,sizes,prev, pager, next, jumper">
                </el-pagination>
        </el-row>


        <el-dialog title="车辆详细信息" :visible.sync="carDialog" :show-close="true" :close-on-press-escape="true" :close-on-click-modal="false" :fullscreen="true">
            <el-row>
                <el-row style="vertical-align: middle;">
                    <el-col :xs="24" :sm="12" :md="8">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="通行时间">
                                <span>{{data.passTime}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :span="24">
                        <el-divider content-position="left">基础信息</el-divider>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌号码">
                                <span>{{data.plateNum}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌颜色">
                                <span>{{data.plateColor}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车身颜色">
                                <span>{{data.vehicleColor}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆类型">
                                <span>{{data.vehicleType}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="出入标识">
                                <span v-if="data.status == '0'">入</span>
                                <span v-else-if="data.status == '1'">出</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="区域代码">
                                <span>{{data.area}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所代码">
                                <span>{{data.darea}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所名称">
                                <span>{{data.dareaName}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所类型">
                                <span v-if="data.placeType == '01'">封闭式小区</span>
                                <span v-if="data.placeType == '02'">小区</span>
                                <span v-if="data.placeType == '03'">无人管理小区</span>
                                <span v-if="data.placeType == '04'">旅店/宾馆/酒店</span>
                                <span v-if="data.placeType == '05'">停车场</span>
                                <span v-if="data.placeType == '06'">娱乐场所</span>
                                <span v-if="data.placeType == '07'">政府单位</span>
                                <span v-if="data.placeType == '08'">企事业单位</span>
                                <span v-if="data.placeType == '09'">学校</span>
                                <span v-if="data.placeType == '10'">机场/车站</span>
                                <span v-if="data.placeType == '11'">宗教场所</span>
                                <span v-if="data.placeType == '12'">医院</span>
                                <span v-if="data.placeType == '13'">超市/商场/市场</span>
                                <span v-if="data.placeType == '14'">广场/公园</span>
                                <span v-if="data.placeType == '15'">体育馆</span>
                                <span v-if="data.placeType == '16'">旅游景点</span>
                                <span v-if="data.placeType == '99'">其它</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :span="24">
                        <el-row>
                            <el-col :xs="24" :sm="12" :md="12">
                                <el-form label-position="left" inline class="table-expand">
                                    <el-form-item label="车辆照片">
                                        <el-image v-if="data.vehicleImg != ''" :preview-src-list="
                                                data.vehicleImg != '' && data.plateImg != ''
                                                ?['./' + data.vehicleImg,'./' + data.plateImg]
                                                : data.vehicleImg != '' && data.plateImg == '' 
                                                    ? [ './' + data.vehicleImg]
                                                    : [ './' + data.plateImg]
                                                " style="width: 10rem;height:10rem;" :src="data.vehicleImg == undefined?'./Storage/undefined.jpg':'./' + data.vehicleImg" fit="scale-down">
                                        </el-image>
                                        <span v-else> 未录入照片 </span>
                                    </el-form-item>
                                </el-form>
                            </el-col>

                            <el-col :xs="24" :sm="12" :md="12">
                                <el-form label-position="left" inline class="table-expand">
                                    <el-form-item label="车牌照片">
                                        <el-image v-if="data.plateImg != ''" :preview-src-list="
                                                data.vehicleImg != '' && data.plateImg != ''
                                                ?['./' + data.vehicleImg,'./' + data.plateImg]
                                                : data.vehicleImg != '' && data.plateImg == '' 
                                                    ? ['./' + data.vehicleImg]
                                                    : ['./' + data.plateImg]
                                                " style="width: 10rem;height:10rem;" :src="data.plateImg== undefined?'./Storage/undefined.jpg':'./' + data.plateImg" fit="scale-down">
                                        </el-image>
                                        <span v-else> 未录入照片 </span>
                                    </el-form-item>
                                </el-form>
                            </el-col>
                        </el-row>
                    </el-col>


                    <el-col :span="24">
                        <el-divider content-position="left">详细信息</el-divider>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="经度">
                                <span>{{data.x}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="纬度">
                                <span>{{data.y}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备ID">
                                <span>{{data.equipmentId}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备名称">
                                <span>{{data.equipmentName}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备类型">
                                <span v-if="data.equipmentType == '01'"> 访客机</span>
                                <span v-if="data.equipmentType == '02'"> 门禁机</span>
                                <span v-if="data.equipmentType == '03'"> 车辆道闸</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备所在地名称">
                                <span>{{data.location}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站编号">
                                <span>{{data.stationId}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站名称">
                                <span>{{data.stationName}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>



                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆类别">
                                <span v-if="data.carType == '1'">业主车辆</span>
                                <span v-if="data.carType == '2'">租户车辆</span>
                                <span v-if="data.carType == '3'">访客车辆</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="访问事由">
                                <span>{{data.visitReason}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="司机信息">
                                <span>{{data.driverData}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="乘客信息">
                                <span>{{data.passengerData}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <div>
                            <el-form label-position="left" inline class="table-expand">
                                <el-form-item label="被访人信息">
                                    <span>{{data.visitor}}</span>
                                </el-form-item>
                            </el-form>
                        </div>
                    </el-col>

                </el-row>
            </el-row>

            <span slot="footer" class="dialog-footer">
					<!-- <el-button @click="()=>{carDialog = false}">取 消</el-button> -->
					<el-button type="primary" @click="()=>{carDialog = false;}">确 定</el-button>
				</span>
        </el-dialog>

        <el-dialog v-if="data" title="车辆信息修改" :visible.sync="carEditDialog" :show-close="true" :close-on-press-escape="true" :close-on-click-modal="false" :fullscreen="true">
            <el-row>
                <el-row style="vertical-align: middle;">

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="通行时间">
                                <span>{{data.passTime}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :span="24">

                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="区域代码">
                                <span>{{data.area}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所代码">
                                <span>{{data.darea}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所名称">
                                <span>{{data.dareaName}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所类型">
                                <span v-if="data.placeType == '01'">封闭式小区</span>
                                <span v-if="data.placeType == '02'">小区</span>
                                <span v-if="data.placeType == '03'">无人管理小区</span>
                                <span v-if="data.placeType == '04'">旅店/宾馆/酒店</span>
                                <span v-if="data.placeType == '05'">停车场</span>
                                <span v-if="data.placeType == '06'">娱乐场所</span>
                                <span v-if="data.placeType == '07'">政府单位</span>
                                <span v-if="data.placeType == '08'">企事业单位</span>
                                <span v-if="data.placeType == '09'">学校</span>
                                <span v-if="data.placeType == '10'">机场/车站</span>
                                <span v-if="data.placeType == '11'">宗教场所</span>
                                <span v-if="data.placeType == '12'">医院</span>
                                <span v-if="data.placeType == '13'">超市/商场/市场</span>
                                <span v-if="data.placeType == '14'">广场/公园</span>
                                <span v-if="data.placeType == '15'">体育馆</span>
                                <span v-if="data.placeType == '16'">旅游景点</span>
                                <span v-if="data.placeType == '99'">其它</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌号码">
                                <span>{{data.plateNum}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="出入标识">
                                <el-select class="w-100" filterable placeholder="出入标识" v-model="data.status" clearable>
                                    <el-option label="入" value="0"></el-option>
                                    <el-option label="出" value="1"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌颜色">
                                <!-- <span>{{data.stationName}}</span> -->
                                <el-input class="w-100" v-model="data.plateColor" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车身颜色">
                                <!-- <span>{{data.stationName}}</span> -->
                                <el-input class="w-100" v-model="data.vehicleColor" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="12">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆照片">
                                <el-image v-if="data.vehicleImg != ''" :preview-src-list="
                					data.vehicleImg != '' && data.plateImg != ''
                					?['./'+data.vehicleImg,'./'+data.plateImg]
                					: data.vehicleImg != '' && data.plateImg == '' 
                						? ['./'+data.vehicleImg]
                						: ['./'+data.plateImg]
                					" style="width: 10rem;height:10rem;" :src="data.vehicleImg == undefined?'./Storage/undefined.jpg':'./'+data.vehicleImg" fit="scale-down">
                                </el-image>
                                <span v-else> 未录入照片 </span>
                                <br>
                                <el-button @click="()=>{carImgUpload()}" type="mini">上传车辆照片</el-button>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="12">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌照片">
                                <el-image v-if="data.plateImg != ''" :preview-src-list="
                					data.vehicleImg != '' && data.plateImg != ''
                					?['./'+data.vehicleImg,'./'+data.plateImg]
                					: data.vehicleImg != '' && data.plateImg == '' 
                						? ['./'+data.vehicleImg]
                						: ['./'+data.plateImg]
                					" style="width: 10rem;height:10rem;" :src="data.plateImg== undefined?'./Storage/undefined.jpg':'./'+data.plateImg" fit="scale-down">
                                </el-image>
                                <span v-else> 未录入照片 </span>
                                <br>
                                <el-button @click="()=>{idCardImgUpload()}" type="mini">上传车牌照片</el-button>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="经度">
                                <!-- <span>{{data.x}}</span> -->
                                <el-input-number class="w-100" v-model="data.x" :min="-180" :precision="6" :step="0.000001" :max="180"></el-input-number>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="纬度">
                                <!-- <span>{{data.y}}</span> -->
                                <el-input-number class="w-100" v-model="data.y" :min="-180" :precision="6" :step="0.000001" :max="180"></el-input-number>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备ID">
                                <span>{{data.equipmentId}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备名称">
                                <span>{{data.equipmentName}}</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备类型">
                                <span v-if="data.equipmentType == '01'"> 访客机</span>
                                <span v-if="data.equipmentType == '02'"> 门禁机</span>
                                <span v-if="data.equipmentType == '03'"> 车辆道闸</span>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备所在地名称">
                                <!-- <span>{{data.location}}</span> -->
                                <el-input class="w-100" class="w-100" v-model="data.location" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站编号">
                                <!-- <span>{{data.stationId}}</span> -->
                                <el-input class="w-100" v-model="data.stationId" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站名称">
                                <!-- <span>{{data.stationName}}</span> -->
                                <el-input class="w-100" v-model="data.stationName" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>



                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆类别">
                                <el-select class="w-100" filterable placeholder="车辆类别" v-model="data.carType" clearable>
                                    <el-option label="业主车辆" value="1"></el-option>
                                    <el-option label="租户车辆" value="2"></el-option>
                                    <el-option label="访客车辆" value="3"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="访问事由">
                                <!-- <span>{{data.visitReason}}</span> -->
                                <el-input class="w-100" v-model="data.visitReason" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="司机信息 JSON">
                                <!-- <span>{{data.imsi}}</span> -->
                            </el-form-item>
                            <el-input class="w-100" v-model="data.driverData" clearable></el-input>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="乘客信息 JSON">
                                <!-- <span>{{data.imei}}</span> -->
                            </el-form-item>
                            <el-input class="w-100" v-model="data.passengerData" clearable></el-input>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <div>
                            <el-form label-position="left" inline class="table-expand">
                                <el-form-item label="被访人信息 JSON">
                                    <!-- <span>{{data.visitor}}</span> -->
                                </el-form-item>
                                <el-input class="w-100" v-model="data.visitor" clearable></el-input>
                            </el-form>
                        </div>
                    </el-col>


                </el-row>
            </el-row>

            <input id="carImgUpload" style="display: none;" class="btn" type="file" onchange="car.imgChange(this,car.data,'vehicleImg')" accept="image/png,image/gif,image/jpeg" />

            <input id="idCardImgUpload" style="display: none;" class="btn" type="file" onchange="car.imgChange(this,car.data,'plateImg')" accept="image/png,image/gif,image/jpeg" />

            <span slot="footer" class="dialog-footer">
					<el-button @click="()=>{CurrentChange();carEditDialog = false}">取 消</el-button>
					<el-button type="primary" @click="()=>{update(data)}">确 定</el-button>
				</span>
        </el-dialog>

        <el-dialog title="车辆信息添加" :visible.sync="carAddDialog" :show-close="true" :close-on-press-escape="true" :close-on-click-modal="false" :fullscreen="true">
            <el-row>
                <el-row style="vertical-align: middle;">

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="通行时间">
                                <!-- <span>{{data.passTime}}</span> -->
                                <el-date-picker class="w-100" type="datetime" placeholder="选择日期时间" v-model="data.passTime" clearable>
                                </el-date-picker>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :span="24">

                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="区域">
                                <!-- <span>{{data.area}}</span> -->
                                <el-select v-model="data.area" remote :remote-method="(v)=>{loadArea(v)}" @change="(v)=>{loadArea(v);data.darea = '';}" filterable placeholder="请选择区域">
                                    <div v-for="(v,k) in areaList">
                                        <el-option v-for="(val,key) in v" :key="k" :label="val" :value="k">
                                        </el-option>
                                    </div>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所">
                                <!-- <span>{{data.darea}}</span> -->
                                <el-select v-model="data.darea" remote :remote-method="(v)=>{}" @change="(v)=>{
									getEquipment(data.area,data.darea); 
									equipmentList = []
									data.equipmentId = ''
									if(permission == 8)
									{
										data.dareaName = dareaList[data.area].areaName + ':' + dareaList[data.area].darea[data.darea].dareaName
									}
									else{
										data.dareaName = dareaList[data.area].darea[data.darea].dareaName
									}
									data.placeType = v.substr(13,2)
									
								}" filterable placeholder="请选择场所" :disabled="data.area == null">
                                    <div v-if="(Object.keys(areaList).length != 0 && data.area != null && data.area.length != 0)">
                                        <el-option v-for="(v,k) in dareaList[data.area].darea" :key="k" :label="v.dareaName" :value="k" v-if="permission == '8' || v.addCar == '1'">
                                        </el-option>
                                    </div>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所名称">
                                <!-- <span>{{data.dareaName}}</span> -->
                                <el-input v-model="data.dareaName" :disabled="true">
                                </el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="场所类型">
                                <el-select class="w-100" filterable placeholder="场所类型" v-model="data.placeType" clearable :disabled="true">
                                    <el-option label="封闭式小区" value="01"></el-option>
                                    <el-option label="小区" value="02"></el-option>
                                    <el-option label="无人管理小区" value="03"></el-option>
                                    <el-option label="旅店/宾馆/酒店" value="04"></el-option>
                                    <el-option label="停车场" value="05"></el-option>
                                    <el-option label="娱乐场所" value="06"></el-option>
                                    <el-option label="政府单位" value="07"></el-option>
                                    <el-option label="企事业单位" value="08"></el-option>
                                    <el-option label="学校" value="09"></el-option>
                                    <el-option label="车站/机场" value="10"></el-option>
                                    <el-option label="宗教场所" value="11"></el-option>
                                    <el-option label="医院" value="12"></el-option>
                                    <el-option label="超市/商场/市场" value="13"></el-option>
                                    <el-option label="广场/公园" value="14"></el-option>
                                    <el-option label="体育馆" value="15"></el-option>
                                    <el-option label="旅游景点" value="16"></el-option>
                                    <el-option label="其他" value="99"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌号码">
                                <!-- <span>{{data.plateNum}}</span> -->
                                <el-input class="w-100" v-model="data.plateNum" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="出入标识">
                                <el-select class="w-100" filterable placeholder="出入标识" v-model="data.status" clearable>
                                    <el-option label="入" value="0"></el-option>
                                    <el-option label="出" value="1"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌颜色">
                                <!-- <span>{{data.plateNum}}</span> -->
                                <el-input class="w-100" v-model="data.plateColor" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆颜色">
                                <!-- <span>{{data.plateNum}}</span> -->
                                <el-input class="w-100" v-model="data.vehicleColor" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆照片">
                                <el-image v-if="data.vehicleImg != ''" :preview-src-list="
                					data.vehicleImg != '' && data.plateImg != ''
                					?[data.vehicleImg,data.plateImg]
                					: data.vehicleImg != '' && data.plateImg == '' 
                						? [data.vehicleImg]
                						: [data.plateImg]
                					" style="width: 10rem;height:10rem;" :src="data.vehicleImg == undefined?'./Storage/undefined.jpg':data.vehicleImg" fit="scale-down">
                                </el-image>
                                <span v-else> 未录入照片 </span>
                                <br>
                                <el-button @click="()=>{carImgAdd()}" type="mini">上传车辆照片</el-button>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <input id="carImgAdd" style="display: none;" class="btn" type="file" onchange="car.imgAdd(this,car.data,'vehicleImg')" accept="image/png,image/gif,image/jpeg" />

                    <input id="idCardImgAdd" style="display: none;" class="btn" type="file" onchange="car.imgAdd(this,car.data,'plateImg')" accept="image/png,image/gif,image/jpeg" />

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车牌照片">
                                <el-image v-if="data.plateImg != ''" :preview-src-list="
                					data.vehicleImg != '' && data.plateImg != ''
                					?[data.vehicleImg,data.plateImg]
                					: data.vehicleImg != '' && data.plateImg == '' 
                						? [data.vehicleImg]
                						: [data.plateImg]
                					" style="width: 10rem;height:10rem;" :src="data.plateImg== undefined?'./Storage/undefined.jpg':data.plateImg" fit="scale-down">
                                </el-image>
                                <span v-else> 未录入照片 </span>
                                <br>
                                <el-button @click="()=>{idCardImgAdd()}" type="mini">上传车牌照片</el-button>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="经度">
                                <!-- <span>{{data.x}}</span> -->
                                <el-input-number class="w-100" v-model="data.x" :min="-180" :precision="6" :step="0.000001" :max="180"></el-input-number>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="纬度">
                                <!-- <span>{{data.y}}</span> -->
                                <el-input-number class="w-100" v-model="data.y" :min="-180" :precision="6" :step="0.000001" :max="180"></el-input-number>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备">
                                <!-- <span>{{data.equipmentId}}</span> -->
                                <el-select v-model="data.equipmentId" remote :remote-method="(v)=>{}" @change="(v)=>{
									equipmentList.forEach((x)=>{
										if(x.equipmentId == v)
										{
											data.equipmentName = x.equipmentName
										}
									})
									data.equipmentType = data.equipmentId.substr(13,2)
										
								}" filterable placeholder="请选择设备">
                                    <div v-for="(v,k) in equipmentList">
                                        <el-option :key="k" :label="v.equipmentName" :value="v.equipmentId">
                                        </el-option>
                                    </div>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备名称">
                                <!-- <span>{{data.equipmentName}}</span> -->
                                <el-input v-model="data.equipmentName" :disabled="true">
                                </el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备类型">
                                <!-- <span v-if="data.equipmentType == '01'"> 访客机</span>
                                <span v-if="data.equipmentType == '02'"> 门禁机</span>
								<span v-if="data.equipmentType == '03'"> 车辆道闸></span> -->
                                <el-select class="w-100" filterable placeholder="登记设备类型" v-model="data.equipmentType" clearable :disabled="true">
                                    <el-option label="访客机" value="01"></el-option>
                                    <el-option label="门禁机" value="02"></el-option>
                                    <el-option label="车辆道闸" value="03"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="设备所在地名称">
                                <!-- <span>{{data.location}}</span> -->
                                <el-input class="w-100" class="w-100" v-model="data.location" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站编号">
                                <!-- <span>{{data.stationId}}</span> -->
                                <el-input class="w-100" v-model="data.stationId" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="警务站名称">
                                <!-- <span>{{data.stationName}}</span> -->
                                <el-input class="w-100" v-model="data.stationName" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="车辆类别">
                                <!--                                <span v-if="data.identity == '1'">封闭式小区</span>
                                <span v-if="data.identity == '2'">小区</span>
                                <span v-if="data.identity == '3'">无人管理小区</span> -->
                                <el-select class="w-100" filterable placeholder="车辆类别" v-model="data.identity" clearable>
                                    <el-option label="业主车辆" value="1"></el-option>
                                    <el-option label="租户车辆" value="2"></el-option>
                                    <el-option label="访客车辆" value="3"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="12" :md="6">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="访问事由">
                                <!-- <span>{{data.visitReason}}</span> -->
                                <el-input class="w-100" v-model="data.visitReason" clearable></el-input>
                            </el-form-item>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="司机信息 JSON">
                                <!-- <span>{{data.imsi}}</span> -->
                            </el-form-item>
                            <el-input class="w-100" v-model="data.driverData" clearable></el-input>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <el-form label-position="left" inline class="table-expand">
                            <el-form-item label="乘客信息 JSON">
                                <!-- <span>{{data.imei}}</span> -->
                            </el-form-item>
                            <el-input class="w-100" v-model="data.passengerData" clearable></el-input>
                        </el-form>
                    </el-col>

                    <el-col :xs="24" :sm="24" :md="24">
                        <div>
                            <el-form label-position="left" inline class="table-expand">
                                <el-form-item label="被访人信息 JSON">
                                    <!-- <span>{{data.visitor}}</span> -->
                                </el-form-item>
                                <el-input class="w-100" v-model="data.visitor" clearable></el-input>
                            </el-form>
                        </div>
                    </el-col>


                </el-row>
            </el-row>

            <input id="carImgUpload" style="display: none;" class="btn" type="file" onchange="car.imgChange(this,car.data,'vehicleImg')" accept="image/png,image/gif,image/jpeg" />

            <input id="idCardImgUpload" style="display: none;" class="btn" type="file" onchange="car.imgChange(this,car.data,'plateImg')" accept="image/png,image/gif,image/jpeg" />

            <span slot="footer" class="dialog-footer">
					<el-button @click="()=>{CurrentChange();carAddDialog = false}">取 消</el-button>
					<el-button type="primary" @click="()=>{add(data)}">确 定</el-button>
				</span>
        </el-dialog>


    </div>
    <script>
        var car = new Vue({
            el: '#car',
            watch: {},
            computed: {},
            mounted() {},
            data() {
                return {

                    carDialog: false,
                    carAddDialog: false,
                    carEditDialog: false,
                    carNum: 0,

                    fileData: '',

                    firstLoadDialog: true,
                    areaDialog: false,

                    carFlag: false,
                    activeIndex: '3',
                    userName: '',
                    role: "",
                    permission: "",

                    Tab: "车辆管理",

                    data: {},
                    userInfo: "",

                    dialogWidth: 0,

                    roleListPage: 1,
                    roleListNum: 1000,

                    roleList: [],

                    areaList: {},
                    area: '',
                    areaName: '',
                    dareaList: {},
                    darea: "",
                    dareaName: '',
                    equipmentList: [],


                    carData: {
                        data: [],
                        count: 0,
                        num: 10,
                        page: 1,
                        timeFilter: '0',
                        tempFilter: '0',
                        compareScoreFilter: '0',
                        searchPlan: 0,
                        searchArea: '',
                        searchDarea: '',
                        filter: {
                            plateNum: '',
                            gender: undefined,
                            nation: '',
                            idCard: undefined,
                            cardType: undefined,
                            countryOrAreaCode: undefined,
                            countryOrAreaName: undefined,
                            cardVersion: undefined,
                            currentApplyOrgCode: undefined,
                            signNum: undefined,
                            address: undefined,
                            passTime: undefined,
                            beforeTime: undefined,
                            afterTime: undefined,
                            betweenTime: undefined,
                            equipmentId: undefined,
                            equipmentName: undefined,
                            equipmentType: undefined,
                            status: undefined,
                            stationId: undefined,
                            stationName: undefined,
                            placeType: undefined,
                            identity: undefined,
                            homePlace: undefined,
                            contact: undefined,
                            isConsist: undefined,
                            higherCompareScore: undefined,
                            lowerCompareScore: undefined,
                            openMode: undefined,
                            visitReason: undefined,
                            mac: undefined,
                            imsi: undefined,
                            imei: undefined,
                        },
                    },
                }
            },
            created() {
                this.setDialogWidth()
                this.GetRequest()
            },
            methods: {
                getEquipment(area, darea) {
                    axios.post('./System/Core/Management.php', Qs.stringify({
                        "getEquipmentList": '',
                        "page": "1",
                        "num": "9999999999999",
                        "area": area,
                        "darea": darea,
                    }), ).then(function(res) {
                        if ('error' in res.data) {
                            car.$message({
                                showClose: true,
                                message: '没有查询 ' + car.dareaList[area].darea[darea].dareaName + ' 设备的权限，无法选择设备信息',
                                type: 'error',
                                duration: 5000
                            });
                        } else {
                            car.equipmentList = res.data.slice(1)
                            console.log(car.equipmentList)
                        }
                    })
                },
                loadArea(v) {
                    if (car.permission != '8') {
                        return car.areaList
                    }

                    if (v.length != 0) {

                        car.areaList = {}
                        console.log(v)

                        if (/^[0-9]{9}$/.test(v)) {
                            axios.post('./System/Core/Management.php', Qs.stringify({
                                "getPlanList": '',
                                "page": "1",
                                "num": "9999999999999",
                                "filter": JSON.stringify({
                                    "area": v,
                                })
                            }), ).then(function(res) {
                                data = res.data.slice(1)
                                for (t in data) {

                                    if (!(data[t]['area'] in car.areaList)) {
                                        car.areaList[data[t]['area']] = {
                                            'areaName': data[t]['areaName']
                                        }
                                    }

                                    // console.log(car.areaList,car.roleList[t]['areaCode'],car.roleList[t]['areaName'])

                                    if (!(data[t]['area'] in car.dareaList)) {
                                        car.dareaList[data[t]['area']] = {
                                            'areaName': data[t]['areaName'],
                                            'darea': {}
                                        }
                                    }

                                    if (!(data[t]['darea'] in car.dareaList[data[t]['area']]['darea'])) {
                                        car.dareaList[data[t]['area']]['darea'][data[t]['darea']] = {
                                            'dareaName': data[t]['dareaName'],
                                        }
                                    }
                                }
                                car.$set(car.areaList, car.areaList)
                                car.$set(car.dareaList, car.dareaList)
                                car.$forceUpdate()
                            })
                        } else {
                            axios.post('./System/Core/Management.php', Qs.stringify({
                                "getPlanList": '',
                                "page": "1",
                                "num": "9999999999999",
                                "filter": JSON.stringify({
                                    "areaName": v,
                                })
                            }), ).then(function(res) {
                                data = res.data.slice(1)
                                for (t in data) {

                                    if (!(data[t]['area'] in car.areaList)) {
                                        car.areaList[data[t]['area']] = {
                                            'areaName': data[t]['areaName']
                                        }
                                    }

                                    // console.log(car.areaList,car.roleList[t]['areaCode'],car.roleList[t]['areaName'])

                                    if (!(data[t]['area'] in car.dareaList)) {
                                        car.dareaList[data[t]['area']] = {
                                            'areaName': data[t]['areaName'],
                                            'darea': {}
                                        }
                                    }

                                    if (!(data[t]['darea'] in car.dareaList[data[t]['area']]['darea'])) {
                                        car.dareaList[data[t]['area']]['darea'][data[t]['darea']] = {
                                            'dareaName': data[t]['dareaName'],
                                        }
                                    }
                                }
                                car.$set(car.areaList, car.areaList)
                                car.$set(car.dareaList, car.dareaList)
                                car.$forceUpdate()
                            })
                        }
                    }

                },
                add(data) {
                    for (x in data) {

                        if (x == 'passTime' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请填写通行时间',
                                type: 'error'
                            });
                            return
                        } else if (x == 'area' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请选择区域',
                                type: 'error'
                            });
                            return
                        } else if (x == 'darea' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请选择场所',
                                type: 'error'
                            });
                            return
                        } else if (x == 'plateNum' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请填写车牌号码',
                                type: 'error'
                            });
                            return
                        } else if (x == 'status' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请选择出入标识',
                                type: 'error'
                            });
                            return
                        } else if (x == 'equipmentId' && (data[x] == null || data[x].length == 0)) {
                            car.$message({
                                showClose: true,
                                message: '请选择登记设备',
                                type: 'error'
                            });
                            return
                        }

                        if (data[x] == null || data[x].length == 0) {
                            data[x] = undefined
                        }

                        if (x == 'passTime' && data[x] != null) {
                            data[x] = car.getTime(data[x])
                        }

                        if (
                            (x.indexOf('birth') != -1 || x.indexOf('validty') != -1) &&
                            data[x] != null && data[x].length != 0
                        ) {
                            data[x] = car.getTime(Date.parse(data[x])).split(' ')[0]
                        }

                        if (x.indexOf('Img') != -1 && data[x] != null && data[x].indexOf('base64') == -1) {
                            data[x] = undefined
                        }
                    }

                    axios.post('./System/Core/Management.php', Qs.stringify({
                        "addCar": '',
                        'area': data.area,
                        'darea': data.darea,
                        "data": JSON.stringify(data)
                    }), ).then(function(res) {
                        if ('success' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.success,
                                type: 'success'
                            });
                            car.carEditDialog = false;
                        }
                        if ('error' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.error,
                                type: 'error'
                            });
                        }
                        if ('info' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.info,
                                type: 'info'
                            });
                            car.carAddDialog = false;
                        }

                        car.CurrentChange()
                    })
                },
                showAddCarDialog() {
                    car.data = {
                        area: undefined,
                        darea: undefined,
                        dareaName: undefined,
                        plateNum: undefined,
                        gender: undefined,
                        nation: undefined,
                        idCard: undefined,
                        cardType: undefined,
                        countryOrAreaCode: undefined,
                        countryOrAreaName: undefined,
                        cardVersion: undefined,
                        currentApplyOrgCode: undefined,
                        signNum: undefined,
                        address: undefined,
                        passTime: undefined,
                        equipmentId: undefined,
                        equipmentName: undefined,
                        equipmentType: undefined,
                        status: undefined,
                        stationId: undefined,
                        stationName: undefined,
                        plateType: undefined,
                        identity: undefined,
                        homePlace: undefined,
                        contact: undefined,
                        isConsist: undefined,
                        higherCompareScore: undefined,
                        lowerCompareScore: undefined,
                        openMode: undefined,
                        visitReason: undefined,
                        mac: undefined,
                        imsi: undefined,
                        imei: undefined,
                    }

                    car.carAddDialog = true
                },
                del(data) {
                    data = data.row
                    console.log(data)
                    axios.post('./System/Core/Management.php', Qs.stringify({
                        "delCar": '',
                        "data": JSON.stringify({
                            "area": data.area,
                            "darea": data.darea,
                            "passTime": data.passTime,
                            "plateNum": data.plateNum,
                            "idCard": data.idCard,
                        })
                    }), ).then(function(res) {
                        if ('success' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.success,
                                type: 'success'
                            });
                            car.carEditDialog = false;
                        }
                        if ('error' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.error,
                                type: 'error'
                            });
                        }
                        car.CurrentChange()
                    })
                },
                update(data) {
                    console.log()
                    console.log(data)
                    for (x in data) {
                        // console.log(x)
                        if (data[x] == null || data[x].length == 0) {
                            data[x] = undefined
                        }

                        if (
                            (x.indexOf('birth') != -1 || x.indexOf('validty') != -1) &&
                            data[x] != null && data[x].length != 0
                        ) {
                            data[x] = car.getTime(Date.parse(data[x])).split(' ')[0]
                        }

                        if (x.indexOf('Img') != -1 && data[x] != null && data[x].indexOf('base64') == -1) {
                            data[x] = undefined
                        }
                        // console.log(x, data[x])
                    }
                    axios.post('./System/Core/Management.php', Qs.stringify({
                        "updateCar": '',
                        'area': data.area,
                        'darea': data.darea,
                        "data": JSON.stringify(data)
                    }), ).then(function(res) {
                        if ('success' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.success,
                                type: 'success'
                            });
                            car.carEditDialog = false;
                        }
                        if ('error' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.error,
                                type: 'error'
                            });
                        }
                        if ('info' in res.data) {
                            car.$message({
                                showClose: true,
                                message: res.data.info,
                                type: 'info'
                            });
                            car.carEditDialog = false;
                        }

                        car.CurrentChange()
                    })
                },
                idCardImgAdd() {
                    $('#idCardImgAdd').click()
                },
                carImgAdd() {
                    $('#carImgAdd').click()
                },
                async imgAdd(img, data, x) {
                    console.log(data)
                        // 生成一个文件读取的对象
                    console.log(img.files[0])
                    reader = new FileReader();
                    reader.onload = function(ev) {
                            // base64码
                            var imgFile = ev.target.result; //或e.target都是一样的
                            // console.log(imgFile)
                            // data[x] = imgFile
                            car.$set(car.data, x, imgFile)
                        }
                        //发起异步读取文件请求，读取结果为data:url的字符串形式，
                    await reader.readAsDataURL(img.files[0])
                },
                idCardImgUpload() {
                    $('#idCardImgUpload').click()
                },
                carImgUpload() {
                    $('#carImgUpload').click()
                },
                async imgChange(img, data, x) {
                    // 生成一个文件读取的对象
                    console.log(img.files[0])
                    reader = new FileReader();
                    reader.onload = function(ev) {
                            // base64码
                            var imgFile = ev.target.result; //或e.target都是一样的
                            // console.log(imgFile)
                            // data[x] = imgFile
                            car.$set(car.data, x, imgFile)
                        }
                        //发起异步读取文件请求，读取结果为data:url的字符串形式，
                    await reader.readAsDataURL(img.files[0])
                },
                edit(scope) {
                    car.data = scope.row
                    car.carEditDialog = true
                },
                searchDarea(v) {
                    console.log(v)
                },
                select(scope) {
                    car.data = scope.row
                    car.carDialog = true
                },
                search() {
                    car.carData.page = 1
                    this.CurrentChange()
                },
                CurrentChange(v) {

                    for (x in car.carData.filter) {
                        if (car.carData.filter[x] == null) {
                            car.carData.filter[x] = undefined
                        }

                        if (x == 'betweenTime' && car.carData.filter[x] != null && car.carData.filter[x].length ==
                            2) {
                            car.carData.filter[x][0] = this.getTime(car.carData.filter[x][0])
                            car.carData.filter[x][1] = this.getTime(car.carData.filter[x][1])
                        } else if (x.indexOf('Time') != -1 && car.carData.filter[x] != null && car.carData
                            .filter[
                                x].length != 0) {
                            car.carData.filter[x] = this.getTime(car.carData.filter[x])
                        }

                        // console.log(x, car.carData.filter[x])
                    }

                    if (car.carData.searchPlan == null || car.carData.searchPlan.length == 0) {
                        car.carData.searchArea = car.area
                        car.carData.searchDarea = car.darea
                    } else if (car.carData.searchPlan != '0') {
                        car.carData.searchDarea = car.carData.searchPlan
                    } else {
                        if (car.carData.searchPlan == '0') {
                            if (car.permission != '8') {
                                car.carData.searchArea = []
                                car.carData.searchDarea = []
                                for (x in car.roleList) {
                                    if (car.roleList[x].selectCar == '1') {
                                        if (car.carData.searchArea.indexOf(car.roleList[x].areaCode) == -1) {
                                            car.carData.searchArea.push(car.roleList[x].areaCode)
                                        }

                                        if (car.carData.searchDarea.indexOf(car.roleList[x].dareaCode) == -1) {
                                            car.carData.searchDarea.push(car.roleList[x].dareaCode)
                                        }
                                    }
                                }
                            } else {
                                car.carData.searchArea = undefined
                                car.carData.searchDarea = undefined
                            }
                        }
                    }

                    axios.post('./System/Core/Management.php', Qs.stringify({
                        "getCarList": '',
                        'page': car.carData.page,
                        'num': car.carData.num,
                        'area': car.carData.searchArea instanceof Array ? undefined : car.carData.searchArea,
                        'areaList': car.carData.searchArea instanceof Array ? JSON.stringify(car.carData
                            .searchArea) : undefined,
                        'darea': car.carData.searchDarea instanceof Array ? undefined : car.carData.searchDarea,
                        'dareaList': car.carData.searchDarea instanceof Array ? JSON.stringify(car.carData
                            .searchDarea) : undefined,
                        'filter': JSON.stringify(car.carData.filter)
                    }), ).then(function(res) {
                        if ('error' in res.data) {
                            car.$alert(res.data.error, '错误', {
                                confirmButtonText: '确定',
                                type: 'error',
                                center: true,
                                callback: action => {
                                    // car.linkTo('./management.html')
                                }
                            })
                            return
                        }
                        car.carData.count = parseInt(res.data[0])
                        car.carData.data = res.data.slice(1)
                    })
                },
                change(v) {
                    if (v == null) {
                        return undefined
                    }
                    if (v.length == 0) {
                        return undefined
                    } else {
                        return v
                    }
                },
                clear() {
                    return undefined
                },
                changeUrl(k, v) {
                    history.pushState({}, '', this.changeURLArg(k, v));
                },
                changeURLArg(arg, arg_val) {
                    // var url = window.location.href.replace(window.location.search,'')
                    var url = window.location.href
                    var pattern = arg + '=([^&]*)';
                    var replaceText = arg + '=' + arg_val;
                    if (url.match(pattern)) {
                        var tmp = '/(' + arg + '=)([^&]*)/gi';
                        tmp = url.replace(eval(tmp), replaceText);
                        return tmp;
                    } else {
                        if (url.match('[\?]')) {
                            return url + '&' + replaceText;
                        } else {
                            return url + '?' + replaceText;
                        }
                    }
                    return url + '\n' + arg + '\n' + arg_val;
                },
                GetRequest() {
                    var url = location.search; //获取url中"?"符后的字串
                    var theRequest = new Object();
                    if (url.indexOf("?") != -1) {
                        var str = url.substr(1);
                        strs = str.split("&");
                        for (var i = 0; i < strs.length; i++) {
                            theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
                        }
                    }
                    this.Request = theRequest
                },
                getCarCount(page, num) {
                    time = []
                    t = car.getTime(new Date()).replace(/-/g, ' ').replace(/:/g, ' ').split(' ')
                    time[0] = t[0] + '-' + t[1] + '-' + t[2]
                    t = car.getTime(Date.parse(time[0]) + 1000 * 60 * 60 * 24).replace(/-/g, ' ').replace(/:/g, ' ').split(
                        ' ')
                    time[1] = t[0] + '-' + t[1] + '-' + t[2]

                    if (car.role == '超级管理员') {
                        data = Qs.stringify({
                            "getCarList": '',
                            "page": "1",
                            "num": "0",
                            // "filter": JSON.stringify({
                            // 	"betweenTime": JSON.stringify(time),
                            // })
                        })
                    } else {
                        data = Qs.stringify({
                            "getCarList": '',
                            "page": "1",
                            "num": "0",
                            'area': car.area,
                            'darea': car.darea,
                            // "filter": JSON.stringify({
                            // 	"betweenTime": JSON.stringify(time),
                            // })
                        })
                    }
                    axios.post('./System/Core/Management.php', data).then(function(res) {
                        // console.log(res)
                        car.carNum = res.data[0]
                    })
                },
                saveDefault() {
                    sessionStorage.setItem("area", car.area)
                    sessionStorage.setItem("darea", car.darea)
                },
                loadDarea(v) {
                    car.areaName = car.dareaList[car.area].areaName
                    car.dareaName = car.dareaList[car.area].darea[car.darea].dareaName
                    car.getCarCount()
                    car.changeUrl('area', car.area)
                    car.changeUrl('darea', car.darea)

                    car.CurrentChange()

                    car.carData.searchPlan = car.darea
                    car.carData.searchArea = car.area
                    car.carData.searchDarea = car.darea

                    if (car.permission != '8') {
                        return car.dareaList
                    }

                },
                setDialogWidth() {
                    // console.log(document.body.clientWidth)
                    var val = document.body.clientWidth
                    const def = 800 // 默认宽度
                    if (val < def) {
                        this.dialogWidth = '100%'
                    } else {
                        this.dialogWidth = def + 'px'
                    }
                },
                linkTo(target) {
                    window.location = target
                },
                getSomeTime(n) {
                    return car.getTime(Date.parse(car.getTime(Math.ceil((new Date().getTime() / 100000) * 100000))
                            .split(
                                ':')[0] +
                            ':' +
                            (parseInt(car.getTime(Math.ceil(new Date().getTime() / 100000) * 100000).split(':')[1]) -
                                parseInt(
                                    car.getTime(Math.ceil(new Date().getTime() / 100000) * 100000).split(':')[1]) % 5)) + 60 * 1000 *
                        (5 *
                            n))
                },
                getTime(unixTime) {
                    unixTime = new Date(unixTime)
                    Y = unixTime.getFullYear()
                    M = (unixTime.getMonth() + 1) < 10 ? '0' + (unixTime.getMonth() + 1) : (unixTime.getMonth() + 1)
                    D = unixTime.getDate() < 10 ? '0' + unixTime.getDate() : unixTime.getDate()
                    H = unixTime.getHours() < 10 ? '0' + unixTime.getHours() : unixTime.getHours()
                    i = unixTime.getMinutes() < 10 ? '0' + unixTime.getMinutes() : unixTime.getMinutes()
                    S = unixTime.getSeconds() < 10 ? '0' + unixTime.getSeconds() : unixTime.getSeconds()
                    return Y + '-' + M + '-' + D + ' ' + H + ':' + i + ':' + S
                },
                handleSelect(key, keyPath) {
                    console.log(key, keyPath);
                },
                logout() {
                    axios.post('./System/Core/User.php', Qs.stringify({
                        "logout": '',
                    }), ).then(function(res) {
                        for (x in res.data) {
                            if ('success' === x) {
                                console.log(res.data['success'])
                                car.$alert(res.data['success'], '操作成功', {
                                    confirmButtonText: '确定',
                                    type: 'success',
                                    center: true,
                                    callback: action => {
                                        window.location = 'login.html'
                                    }
                                })
                            }
                        }
                    })
                },
            },
            mounted() {
                window.onresize = () => {
                    return (() => {
                        this.setDialogWidth()
                    })()
                }
                axios.post('./System/Core/User.php', Qs.stringify({
                    "getUserInfo": '',
                }), ).then(function(res) {
                    for (x in res.data) {
                        if ('error' === x) {
                            car.$alert(res.data[x], '错误', {
                                confirmButtonText: '确定',
                                type: 'error',
                                center: true,
                                callback: action => {
                                    window.location = 'login.html'
                                }
                            })
                        } else {
                            car.userName = res.data[x]['userName']
                            car.userInfo = res.data[x]
                            car.permission = res.data[x]['permission']

                            if (car.permission == '8') {
                                car.role = '超级管理员'
                                car.CurrentChange()
                                car.areaDialog = false
                            } else if (car.permission == '1') {
                                car.role = '管理员'
                            } else {
                                car.linkTo('./')
                            }

                            car.carFlag = true

                            if (car.permission != '8') {
                                axios.post('./System/Core/Management.php', Qs.stringify({
                                    "getRoleList": '',
                                }), ).then(function(res) {
                                    if (res.data[0] == 0) {
                                        car.$alert('您没有访问面板的权限，如需访问请联系超级管理员添加相应权限', '错误', {
                                            confirmButtonText: '返回首页',
                                            type: 'error',
                                            center: true,
                                            callback: action => {
                                                car.linkTo('./')
                                            }
                                        })
                                    }
                                    // console.log(res.data)
                                    car.roleList = res.data.slice(1)
                                    for (t in car.roleList) {
                                        // console.log(car.roleList[t]['areaCode'])

                                        if (!(car.roleList[t]['areaCode'] in car.areaList)) {
                                            car.areaList[car.roleList[t]['areaCode']] = {
                                                'areaName': car.roleList[t]['areaName']
                                            }
                                        }

                                        console.log(car.areaList, car.roleList[t]['areaCode'], car.roleList[t]['areaName'])

                                        if (!(car.roleList[t]['areaCode'] in car.dareaList)) {
                                            car.dareaList[car.roleList[t]['areaCode']] = {
                                                'areaName': car.roleList[t]['areaName'],
                                                'darea': {}
                                            }
                                        }

                                        if (!(car.roleList[t]['dareaCode'] in car.dareaList[car.roleList[t]['areaCode']][
                                                'darea'
                                            ])) {
                                            car.dareaList[car.roleList[t]['areaCode']]['darea'][car.roleList[t]['dareaCode']] = {
                                                'dareaName': car.roleList[t]['dareaName'],

                                                'selectCar': car.roleList[t]['selectCar'] == 0 ? false : true,
                                                'selectCar': car.roleList[t]['selectCar'] == 0 ? false : true,
                                                'selectEquipment': car.roleList[t]['selectEquipment'] == 0 ? false : true,

                                                'updateCar': car.roleList[t]['updateCar'] == 0 ? false : true,
                                                'updateCar': car.roleList[t]['updateCar'] == 0 ? false : true,
                                                'updateEquipment': car.roleList[t]['updateEquipment'] == 0 ? false : true,

                                                'delCar': car.roleList[t]['delCar'] == 0 ? false : true,
                                                'delCar': car.roleList[t]['delCar'] == 0 ? false : true,
                                                'delEquipment': car.roleList[t]['delEquipment'] == 0 ? false : true,

                                                'addCar': car.roleList[t]['addCar'] == 0 ? false : true,
                                                'addCar': car.roleList[t]['addCar'] == 0 ? false : true,
                                                'addEquipment': car.roleList[t]['addEquipment'] == 0 ? false : true,
                                            }
                                        }

                                    }

                                    car.$set(car.areaList, car.areaList)
                                    car.$set(car.dareaList, car.dareaList)

                                    // car.CurrentChange()



                                    if ('area' in car.Request) {
                                        if (car.Request.area in car.areaList) {
                                            car.area = car.Request.area
                                            car.carData.searchArea = car.area
                                            if ('darea' in car.Request) {
                                                if (car.Request.darea in car.dareaList[car.area].darea) {
                                                    car.darea = car.Request.darea
                                                    car.carData.searchDarea = car.darea
                                                    car.carData.searchPlan = car.darea
                                                    car.areaDialog = false
                                                    car.getCarCount()
                                                        // car.loadDarea()
                                                } else {
                                                    car.$alert('您没有管理该区域/场所的权限，或该区域/场所不存在', '错误', {
                                                        confirmButtonText: '确定',
                                                        type: 'error',
                                                        center: true,
                                                        callback: action => {}
                                                    })
                                                }
                                            }
                                        } else {
                                            car.$alert('您没有管理该区域/场所的权限，或该区域/场所不存在', '错误', {
                                                confirmButtonText: '确定',
                                                type: 'error',
                                                center: true,
                                                callback: action => {}
                                            })
                                        }
                                    } else {
                                        if (sessionStorage.getItem("area") != null) {
                                            if (sessionStorage.getItem("area") in car.areaList) {
                                                if (sessionStorage.getItem("darea") != null) {
                                                    car.area = sessionStorage.getItem("area")
                                                    car.carData.searchArea = car.area
                                                    if (sessionStorage.getItem("darea") in car.dareaList[car.area].darea) {
                                                        car.darea = sessionStorage.getItem("darea")
                                                        car.carData.searchPlan = sessionStorage.getItem("darea")
                                                        car.areaDialog = false

                                                    } else {
                                                        car.$alert('默认区域/场所 权限错误，请重新选择', '错误', {
                                                            confirmButtonText: '确定',
                                                            type: 'error',
                                                            center: true,
                                                            callback: action => {
                                                                car.areaDialog = true
                                                            }
                                                        })
                                                    }
                                                }
                                            } else {
                                                car.$alert('默认区域/场所 权限错误，请重新选择', '错误', {
                                                    confirmButtonText: '确定',
                                                    type: 'error',
                                                    center: true,
                                                    callback: action => {
                                                        car.areaDialog = true
                                                    }
                                                })
                                            }
                                        } else if (sessionStorage.getItem("area") == null) {
                                            car.areaDialog = true
                                        }
                                    }
                                    car.CurrentChange()
                                    console.log(car.dareaList)
                                })
                            }

                            // car.getCarCount()

                        }
                    }
                })
            }
        })
    </script>

    </div>
    <style>
        .table-expand {
            font-size: 0;
        }
        
        .table-expand label {
            width: 50%;
            color: #99a9bf;
        }
        
        .table-expand .el-form-item {
            margin-right: 0;
            margin-bottom: 0;
            width: 100%;
        }
    </style>
    <script type="text/javascript">
        var resetWindow = function() {
            $('#car').css({
                'min-height': $(window).height() - $('#head').height() - $('#foot').height()
            })

            if ($(window).width() <= 995) {
                car.tabPosition = 'top'
                $('#car').css({
                    'margin': '0 10px',
                    'margin-top': '5px'
                })
            } else {
                car.tabPosition = 'left'
                $('#car').css({
                    'margin': '0 5px',
                    'margin-top': '5px'
                })
            }
        }
        $(document).ready(function() {
            resetWindow()
            $(window).resize(function() {
                resetWindow()
            })
        })
    </script>

</html>